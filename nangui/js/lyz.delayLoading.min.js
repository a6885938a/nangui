jQuery.fn.extend({
	delayLoading: function(a) {
		a = jQuery.extend({
			defaultImg: "",
			errorImg: "",
			imgSrcAttr: "src",
			setImg: "originalSrc",
			beforehand: 0,
			event: "scroll",
			duration: "normal",
			container: window,
			success: function() {},
			error: function() {}
		},
		a || {});
		if (a.errorImg === undefined || a.errorImg === null || a.errorImg === "") {
			a.errorImg = a.defaultImg
		}
		var e = jq(this);
		jq("img[" + a.imgSrcAttr + "]").each(function() {
			jq(this).attr(a.setImg, jq(this).attr(a.imgSrcAttr));
			jq(this).attr("src", a.defaultImg)
		});
		function g(d) {
			var b, c;
			if (a.container === undefined || a.container === window) {
				b = jq(window).scrollTop();
				c = jq(window).height() + jq(window).scrollTop()
			} else {
				b = jq(a.container).offset().top;
				c = jq(a.container).offset().top + jq(a.container).height()
			}
			return d.offset().top + d.height() + a.beforehand >= b && c >= d.offset().top - a.beforehand
		}
		function h(d) {
			var b, c;
			if (a.container === undefined || a.container === window) {
				b = jq(window).scrollLeft();
				c = jq(window).width() + jq(window).scrollLeft()
			} else {
				b = jq(a.container).offset().left;
				c = jq(a.container).offset().left + jq(a.container).width()
			}
			return d.offset().left + d.width() + a.beforehand >= b && c >= d.offset().left - a.beforehand
		}
		function f() {
			e.filter("img[" + a.setImg + "]").each(function(d, b) {
				if (jq(b).attr(a.setImg) !== undefined && jq(b).attr(a.setImg) !== null && jq(b).attr(a.setImg) !== "" && g(jq(b)) && h(jq(b))) {
					var c = new Image;
					c.onload = function() {
						jq(b).attr("src", c.src);
						a.duration !== 0 && jq(b).hide().fadeIn(a.duration);
						jq(b).removeAttr(a.setImg);
						a.success(jq(b))
					};
					c.onerror = function() {
						jq(b).attr("src", a.errorImg);
						jq(b).removeAttr(a.setImg);
						a.error(jq(b))
					};
					c.src = jq(b).attr(a.setImg)
				}
			})
		}
		f();
		jq(a.container).bind(a.event,
		function() {
			f()
		})
	}
});